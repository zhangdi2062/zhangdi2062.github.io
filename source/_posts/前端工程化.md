---
title: 前端工程化
tags:
  - js
  - ts
  - vite
  - pnpm
categories:
  - 前端
date: 2024-03-25 10:49:57
---

# 前端工程化

## 自定义 resize hook

### 需求

实现一个函数同时支持 hook 和自定义指令，去监听 dom 宽高的变化

### 分析

1. 如何监听 dom 宽高的变化
2. 如何用 vite 打包库
3. 如何发布 npm

### 实现

目录结构

- src
  - index.ts
- index.d.ts
- README.md
- vite.config.ts
- package.json // pnpm init
- tsconfig.json // tsc --init

安装库

`pnpm i vue -D` 这个 hook 库会被 vue 工程安装，所以在开发环境引入 vue 即可
`pnpm i vite -D` 打包工具，同上

## 打包工具

### vite

#### vite 特性

- 快速冷启动
- 模块热更新
- 按需编译，避免编译用不到的文件
- 开箱即用，避免各种 loader 和 plugin 的配置

#### 核心功能

- 静态 web 服务器
- 编译单文件组件
- 拦截浏览器不识别的模块，并处理
- HMR，通过 WebSocket 实现

#### 创建项目

`npm install vite@latest`

### webpack

### rollup

Rollup 是一个现代 JavaScript 的模块打包器，专为 ES6 模块设计，用于将模块打包成格式如 CommonJS 或 AMD 的单个文件，适用于浏览器和 Node.js 环境。

### gulp

Gulp 是一个自动化构建工具，主要用于优化前端工作流程。它通过 JavaScript 编写任务来自动化常见的任务，如文件监听、文件合并、压缩、格式转换等

## 模块化和包管理器

### 解决的问题

1. 全局污染
2. 依赖混乱

### 模块化

每个 js 都是一个模块，可以导出，解决以上两个问题

是前端崛起的号角

### 包管理器

是模块的集合，用于解决某一方面的问题。包管理器解决版本冲突

## 组件库

### 设计原则

1. 单一职责，使组件可复用
2. 通用性，给二次开发者留有余地
   单一职责原则：确保每个组件只关注单一的功能或职责，避免一个组件承担过多的责任。这样可以使组件更加独立、易于测试和修改。
   组件通信：使用适当的组件通信方式，如 Props 和 Events，避免组件直接访问其他组件的状态。通过 Props 向子组件传递数据，通过 Events 向父组件发送消息，可以降低组件之间的耦合度。
   抽象通用逻辑：将通用的逻辑抽象成服务、工具函数或混入（Mixin），让多个组件共享这些逻辑，避免在多个地方重复编写相同的代码。
   解耦 UI 和逻辑：尽量将组件的 UI 和业务逻辑分离，使得组件更容易维护和复用。使用计算属性、监听器和组件生命周期钩子等技术来处理组件的逻辑部分。
   使用插槽（Slot） ：通过插槽机制实现组件的灵活性，让父组件可以动态地向子组件传递内容，从而降低组件之间的依赖关系。
   依赖注入：通过依赖注入的方式将依赖关系从组件中解耦出来，使组件更加灵活和可配置。
   接口设计：设计清晰的接口，明确定义组件之间的交互方式，避免组件之间的直接耦合，提高组件的可替换性。

### 技术选型

1. css
2. js

### 启动项目

1. 打包工具的选择：rollup
2. 代码检测
3. 提交规范
4. 测试工具 Jest
5. 其他，比如自动化构建工具等

## 从 0 搭建一个项目，架构师可以做的

下面内容来自 GPT4o

作为前端架构师，在开发一个项目时需要考虑的内容非常广泛，涵盖了技术选型、系统设计、性能优化、安全性、开发流程等多个方面。以下是一些关键内容和具体考虑事项：

### 1. 技术选型

- **前端框架和库**：选择合适的前端框架（如 React、Vue、Angular）和辅助库（如 Redux、Vuex）。
- **构建工具**：选择和配置构建工具（如 Webpack、Vite、Parcel），确保高效的开发和构建流程。
- **CSS 解决方案**：选择 CSS 预处理器（如 Sass、Less）或 CSS-in-JS 方案（如 Styled Components、Emotion）。
- **测试框架**：选择单元测试、集成测试和端到端测试框架（如 Jest、Mocha、Cypress）。

### 2. 系统架构设计

- **组件设计**：设计高复用性和可维护性的组件，定义组件的职责和边界。
- **状态管理**：选择合适的状态管理方案（如 Redux、MobX、Context API），设计全局和局部状态的管理策略。
- **路由设计**：设计应用的路由结构，选择路由库（如 React Router、Vue Router），处理动态路由和懒加载。
- **API 集成**：设计与后端的 API 接口，处理数据的获取和更新，考虑 API 的版本控制和错误处理。

### 3. 性能优化

- **代码分割**：实现代码分割和懒加载，减少初始加载时间。
- **资源优化**：优化静态资源（如图片、字体），使用合适的压缩和格式（如 WebP）。
- **缓存策略**：设计合理的缓存策略，利用浏览器缓存和服务端缓存（如 Service Worker）。
- **性能监控**：设置性能监控工具（如 Lighthouse、New Relic），持续监控和优化性能。

### 4. 安全性

- **输入验证**：确保所有用户输入都经过验证和清理，防止 XSS 和注入攻击。
- **身份验证和授权**：设计安全的身份验证和授权机制，保护敏感数据和操作。
- **安全通信**：使用 HTTPS 确保数据传输的安全性，防止中间人攻击。
- **依赖管理**：定期检查和更新依赖库，防止使用存在已知漏洞的库。

### 5. 开发流程和工具

- **版本控制**：使用 Git 进行版本控制，设计合理的分支策略（如 Git Flow）。
- **持续集成和持续部署（CI/CD）**：设置 CI/CD 流水线，自动化测试、构建和部署流程。
- **代码规范和 Linting**：制定代码规范，使用 Linting 工具（如 ESLint、Prettier）确保代码一致性。
- **文档和知识共享**：编写详细的技术文档和开发指南，促进团队知识共享。

### 6. 用户体验（UX）

- **响应式设计**：确保应用在不同设备和屏幕尺寸上的良好表现。
- **无障碍性**：遵循无障碍设计原则，确保应用对所有用户友好。
- **性能体验**：优化首屏加载时间和交互响应时间，提升用户体验。

### 7. 团队协作

- **沟通和协作**：与产品经理、设计师、后端开发人员等紧密合作，确保需求和设计的一致性。
- **代码评审**：建立代码评审流程，确保代码质量和知识共享。
- **培训和指导**：为团队成员提供培训和指导，提升整体技术水平。

### 总结

作为前端架构师，需要全面考虑技术选型、系统设计、性能优化、安全性、开发流程、用户体验和团队协作等多个方面。通过系统化的思考和设计，确保项目的高质量和可维护性。
